@import "tailwindcss";
@plugin "tailwindcss-animate";
@plugin "@tailwindcss/typography";

@custom-variant dark (&:is(.dark *));

@theme {
  --font-mono:
    "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
  --font-sans:
    "Open Sans", "Clear Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;

  /* 引用动态变量，使其在 utility 中可用 */
  --color-github-bg: var(--gh-bg);
  --color-github-fg: var(--gh-fg);
  --color-github-border: var(--gh-border);
  --color-github-code-bg: var(--gh-code-bg);
  --color-github-quote-border: var(--gh-quote-border);
  --color-github-quote-text: var(--gh-quote-text);
}

:root {
  /* GitHub Theme Variables (Light) */
  --gh-bg: #ffffff;
  --gh-fg: #24292e;
  --gh-border: #e1e4e8;
  --gh-code-bg: #f3f4f6;
  --gh-quote-border: #dfe2e5;
  --gh-quote-text: #6a737d;

  /* <CHANGE> Modern note-taking app color scheme with purple accent */

  /* Base colors - Clean white background for distraction-free editing */
  --background: oklch(1 0 0); /* Pure white */
  --foreground: oklch(0.2 0 0); /* Rich black for text */

  /* Card & Popover - Subtle elevation */
  --card: oklch(1 0 0);
  --card-foreground: oklch(0.2 0 0);
  --popover: oklch(1 0 0);
  --popover-foreground: oklch(0.2 0 0);

  /* Primary - Elegant purple for main actions */
  --primary: oklch(0.55 0.18 285); /* Rich purple */
  --primary-foreground: oklch(1 0 0);

  /* Secondary - Soft gray for less prominent actions */
  --secondary: oklch(0.96 0 0);
  --secondary-foreground: oklch(0.2 0 0);

  /* Muted - For subtle backgrounds and disabled states */
  --muted: oklch(0.97 0 0);
  --muted-foreground: oklch(0.5 0 0);

  /* Accent - Lighter purple for hover states */
  --accent: oklch(0.96 0.02 285);
  --accent-foreground: oklch(0.25 0 0);

  /* Destructive - Soft red for dangerous actions */
  --destructive: oklch(0.55 0.22 25);
  --destructive-foreground: oklch(0.99 0 0);

  /* Borders & Inputs - Subtle separation */
  --border: oklch(0.92 0 0);
  --input: oklch(0.92 0 0);
  --ring: oklch(0.55 0.18 285); /* Matches primary */

  /* Tag colors - Soft, non-distracting palette */
  --tag-blue: oklch(0.88 0.06 240);
  --tag-green: oklch(0.88 0.08 145);
  --tag-orange: oklch(0.88 0.08 60);
  --tag-pink: oklch(0.88 0.06 340);
  --tag-purple: oklch(0.88 0.06 285);
  --tag-yellow: oklch(0.92 0.08 90);

  /* Sidebar - Distinct from main editor */
  --sidebar: oklch(0.98 0 0); /* Slightly off-white */
  --sidebar-foreground: oklch(0.25 0 0);
  --sidebar-primary: oklch(0.55 0.18 285);
  --sidebar-primary-foreground: oklch(1 0 0);
  --sidebar-accent: oklch(0.94 0.01 285);
  --sidebar-accent-foreground: oklch(0.2 0 0);
  --sidebar-border: oklch(0.9 0 0);
  --sidebar-ring: oklch(0.55 0.18 285);

  /* Editor background - Pure white for focus */
  --editor: oklch(1 0 0);
  --editor-foreground: oklch(0.15 0 0);

  /* Command palette - Spotlight-like appearance */
  --command: oklch(1 0 0);
  --command-foreground: oklch(0.2 0 0);
  --command-border: oklch(0.85 0 0);

  /* Radius - Soft, rounded corners */
  --radius: 0.5rem;
}

.dark {
  /* GitHub Theme Variables (Dark) */
  --gh-bg: #0d1117;
  --gh-fg: #c9d1d9;
  --gh-border: #30363d;
  --gh-code-bg: #161b22;
  --gh-quote-border: #30363d;
  --gh-quote-text: #8b949e;

  /* <CHANGE> Dark mode with rich blacks and purple accent */

  /* Base colors - Deep background for comfortable night reading */
  --background: oklch(0.12 0 0); /* Deep black */
  --foreground: oklch(0.95 0 0); /* Soft white */

  /* Card & Popover - Subtle elevation in dark mode */
  --card: oklch(0.15 0 0);
  --card-foreground: oklch(0.95 0 0);
  --popover: oklch(0.14 0 0);
  --popover-foreground: oklch(0.95 0 0);

  /* Primary - Vibrant purple for dark mode */
  --primary: oklch(0.7 0.2 285);
  --primary-foreground: oklch(0.98 0 0);

  /* Secondary - Dark gray for less prominent actions */
  --secondary: oklch(0.2 0 0);
  --secondary-foreground: oklch(0.95 0 0);

  /* Muted - For subtle backgrounds */
  --muted: oklch(0.18 0 0);
  --muted-foreground: oklch(0.6 0 0);

  /* Accent - Purple tint for hover states */
  --accent: oklch(0.22 0.03 285);
  --accent-foreground: oklch(0.95 0 0);

  /* Destructive - Vibrant red for dark mode */
  --destructive: oklch(0.5 0.2 25);
  --destructive-foreground: oklch(0.95 0 0);

  /* Borders & Inputs */
  --border: oklch(0.25 0 0);
  --input: oklch(0.25 0 0);
  --ring: oklch(0.7 0.2 285);

  /* Tag colors - Muted for dark mode */
  --tag-blue: oklch(0.3 0.08 240);
  --tag-green: oklch(0.3 0.1 145);
  --tag-orange: oklch(0.3 0.1 60);
  --tag-pink: oklch(0.3 0.08 340);
  --tag-purple: oklch(0.3 0.08 285);
  --tag-yellow: oklch(0.35 0.1 90);

  /* Sidebar - Darker than main editor for visual separation */
  --sidebar: oklch(0.1 0 0);
  --sidebar-foreground: oklch(0.9 0 0);
  --sidebar-primary: oklch(0.7 0.2 285);
  --sidebar-primary-foreground: oklch(0.98 0 0);
  --sidebar-accent: oklch(0.18 0.02 285);
  --sidebar-accent-foreground: oklch(0.95 0 0);
  --sidebar-border: oklch(0.2 0 0);
  --sidebar-ring: oklch(0.7 0.2 285);

  /* Editor background - Slightly lighter than base for focus */
  --editor: oklch(0.14 0 0);
  --editor-foreground: oklch(0.92 0 0);

  /* Command palette - Elevated appearance */
  --command: oklch(0.16 0 0);
  --command-foreground: oklch(0.95 0 0);
  --command-border: oklch(0.3 0 0);

  /* Charts - Adjusted for dark mode */
  --chart-1: oklch(0.6 0.2 285);
  --chart-2: oklch(0.65 0.15 200);
  --chart-3: oklch(0.7 0.18 145);
  --chart-4: oklch(0.6 0.15 60);
  --chart-5: oklch(0.65 0.18 340);
}

@theme inline {
  /* --font-sans: "Geist", "Geist Fallback"; */
  /* --font-mono: "Geist Mono", "Geist Mono Fallback"; */

  /* <CHANGE> Map all color variables to Tailwind */
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --color-card: var(--card);
  --color-card-foreground: var(--card-foreground);
  --color-popover: var(--popover);
  --color-popover-foreground: var(--popover-foreground);
  --color-primary: var(--primary);
  --color-primary-foreground: var(--primary-foreground);
  --color-secondary: var(--secondary);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-muted: var(--muted);
  --color-muted-foreground: var(--muted-foreground);
  --color-accent: var(--accent);
  --color-accent-foreground: var(--accent-foreground);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-border: var(--border);
  --color-input: var(--input);
  --color-ring: var(--ring);

  /* Tag colors */
  --color-tag-blue: var(--tag-blue);
  --color-tag-green: var(--tag-green);
  --color-tag-orange: var(--tag-orange);
  --color-tag-pink: var(--tag-pink);
  --color-tag-purple: var(--tag-purple);
  --color-tag-yellow: var(--tag-yellow);

  /* Sidebar colors */
  --color-sidebar: var(--sidebar);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-ring: var(--sidebar-ring);

  /* Editor colors */
  --color-editor: var(--editor);
  --color-editor-foreground: var(--editor-foreground);

  /* Command palette colors */
  --color-command: var(--command);
  --color-command-foreground: var(--command-foreground);
  --color-command-border: var(--command-border);

  /* Chart colors */
  --color-chart-1: var(--chart-1);
  --color-chart-2: var(--chart-2);
  --color-chart-3: var(--chart-3);
  --color-chart-4: var(--chart-4);
  --color-chart-5: var(--chart-5);

  /* Radius scale */
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }

  body {
    @apply bg-background text-foreground;
  }

  /* <CHANGE> Additional typography styles for note-taking */
  h1,
  h2,
  h3,
  h4,
  h5,
  h6 {
    @apply text-balance;
  }

  /* Smooth scrolling for better UX */
  html {
    scroll-behavior: smooth;
  }

  /* Focus visible for accessibility */
  *:focus-visible {
    @apply outline-2 outline-offset-2 outline-ring;
  }
}

/* <CHANGE> Custom utility classes for the note app */
@layer utilities {
  /* Text rendering optimization for better readability */
  .text-optimize {
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
}

/* Tiptap Collaboration Cursor Styles */
.collaboration-cursor__caret {
  position: relative;
  margin-left: -1px;
  margin-right: -1px;
  border-left: 1px solid #0d0d0d;
  border-right: 1px solid #0d0d0d;
  word-break: normal;
  pointer-events: none;
}

/* 暗色模式下光标颜色调整 */
.dark .collaboration-cursor__caret {
  border-color: #fff;
}

.collaboration-cursor__label {
  position: absolute;
  top: -1.4em;
  left: -1px;
  font-size: 12px;
  font-style: normal;
  font-weight: 600;
  line-height: normal;
  user-select: none;
  color: #fff;
  padding: 0.1rem 0.3rem;
  border-radius: 3px 3px 3px 0;
  white-space: nowrap;
  z-index: 1;
}

/* Code syntax highlighting */
.hljs {
  color: #24292e;
  background: transparent;
}

/* 强制覆盖 Tailwind Typography 的 prose-stone 预设样式 */
/* Light Mode */
.prose pre {
  background-color: var(--gh-code-bg) !important;
  color: var(--gh-fg) !important;
  border: 1px solid var(--gh-border);
}

.prose pre code {
  background-color: transparent !important;
  color: inherit !important;
  font-family: var(--font-mono) !important;
}

/* Dark Mode */
.dark .prose pre {
  background-color: #0d1117 !important;
  color: #e1e4e8 !important;
  border: 1px solid #30363d;
}

.dark .prose pre code {
  color: inherit !important;
}

.hljs-doctag,
.hljs-keyword,
.hljs-meta .hljs-keyword,
.hljs-template-tag,
.hljs-template-variable,
.hljs-type,
.hljs-variable.language_ {
  color: #d73a49;
}

.hljs-title,
.hljs-title.class_,
.hljs-title.class_.inherited__,
.hljs-title.function_ {
  color: #6f42c1;
}

.hljs-attr,
.hljs-attribute,
.hljs-literal,
.hljs-meta,
.hljs-number,
.hljs-operator,
.hljs-selector-attr,
.hljs-selector-class,
.hljs-selector-id,
.hljs-variable {
  color: #005cc5;
}

.hljs-meta .hljs-string,
.hljs-regexp,
.hljs-string {
  color: #032f62;
}

.hljs-built_in,
.hljs-symbol {
  color: #e36209;
}

.hljs-code,
.hljs-comment,
.hljs-formula {
  color: #6a737d;
}

.hljs-name,
.hljs-quote,
.hljs-selector-pseudo,
.hljs-selector-tag {
  color: #22863a;
}

.hljs-subst {
  color: #24292e;
}

.hljs-section {
  color: #005cc5;
  font-weight: 700;
}

.hljs-bullet {
  color: #735c0f;
}

.hljs-emphasis {
  color: #24292e;
  font-style: italic;
}

.hljs-strong {
  color: #24292e;
  font-weight: 700;
}

.hljs-addition {
  color: #22863a;
  background-color: #f0fff4;
}

.hljs-deletion {
  color: #b31d28;
  background-color: #ffeef0;
}

/* Dark mode syntax highlighting */
.dark .hljs {
  color: #e1e4e8;
  background: #0d1117;
}

.dark .hljs-doctag,
.dark .hljs-keyword,
.dark .hljs-meta .hljs-keyword,
.dark .hljs-template-tag,
.dark .hljs-template-variable,
.dark .hljs-type,
.dark .hljs-variable.language_ {
  color: #ff7b72;
}

.dark .hljs-title,
.dark .hljs-title.class_,
.dark .hljs-title.class_.inherited__,
.dark .hljs-title.function_ {
  color: #d2a8ff;
}

.dark .hljs-attr,
.dark .hljs-attribute,
.dark .hljs-literal,
.dark .hljs-meta,
.dark .hljs-number,
.dark .hljs-operator,
.dark .hljs-selector-attr,
.dark .hljs-selector-class,
.dark .hljs-selector-id,
.dark .hljs-variable {
  color: #79c0ff;
}

.dark .hljs-meta .hljs-string,
.dark .hljs-regexp,
.dark .hljs-string {
  color: #a5c9ea;
}

.dark .hljs-built_in,
.dark .hljs-symbol {
  color: #ffa657;
}

.dark .hljs-code,
.dark .hljs-comment,
.dark .hljs-formula {
  color: #8b949e;
}

.dark .hljs-name,
.dark .hljs-quote,
.dark .hljs-selector-pseudo,
.dark .hljs-selector-tag {
  color: #7ee787;
}

.dark .hljs-subst {
  color: #e1e4e8;
}

.dark .hljs-section {
  color: #79c0ff;
  font-weight: 700;
}

.dark .hljs-bullet {
  color: #d29922;
}

.dark .hljs-emphasis {
  color: #e1e4e8;
  font-style: italic;
}

.dark .hljs-strong {
  color: #e1e4e8;
  font-weight: 700;
}

.dark .hljs-addition {
  color: #56d364;
  background-color: #0f5132;
}

.dark .hljs-deletion {
  color: #f85149;
  background-color: #67060c;
}
